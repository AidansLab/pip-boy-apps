function ThemePickerLoader(){function f(){try{a.readdirSync('USER')}catch(a){return print('[Theme Picker Loader] USER directory missing.'),null}try{a.readdirSync(b)}catch(c){try{print('[Theme Picker Loader] Creating missing folder:',b),a.mkdir(b)}catch(a){return print('[Theme Picker Loader] Failed to create folder:',a),null}return null}try{let b=a.readFileSync(e);return print('[Theme Picker Loader] Read theme file:',b),JSON.parse(b)}catch(a){return print('[Theme Picker Loader] No theme file found or invalid JSON.'),null}}function h(b){if(b==null&&(settings.palette?b=null:b={gradient:!1,theme0:[0,1,0],theme1:[1,1,1]}),b!=null)if(b.gradient){var c=[new Uint16Array(16),new Uint16Array(16),new Uint16Array(16),new Uint16Array(16)];for(a=0;a<16;a++){let d=0;c[0][a]=g.toColor(((b.theme1[0]-b.theme0[0])*d+b.theme0[0])*a/16,((b.theme1[1]-b.theme0[1])*d+b.theme0[1])*a/16,((b.theme1[2]-b.theme0[2])*d+b.theme0[2])*a/16),d=.33,c[1][a]=g.toColor(((b.theme1[0]-b.theme0[0])*d+b.theme0[0])*a/16-a*.2/16,((b.theme1[1]-b.theme0[1])*d+b.theme0[1])*a/16-a*.2/16,((b.theme1[2]-b.theme0[2])*d+b.theme0[2])*a/16-a*.2/16),d=1,c[2][a]=g.toColor(((b.theme1[0]-b.theme0[0])*d+b.theme0[0])*a/16+a*.2/16,((b.theme1[1]-b.theme0[1])*d+b.theme0[1])*a/16+a*.2/16,((b.theme1[2]-b.theme0[2])*d+b.theme0[2])*a/16+a*.2/16),d=.66,c[3][a]=g.toColor(((b.theme1[0]-b.theme0[0])*d+b.theme0[0])*a/16-a*.4/16,((b.theme1[1]-b.theme0[1])*d+b.theme0[1])*a/16-a*.4/16,((b.theme1[2]-b.theme0[2])*d+b.theme0[2])*a/16-a*.4/16)}Pip.setPalette(c)}else{for(var c=[new Uint16Array(16),new Uint16Array(16),new Uint16Array(16),new Uint16Array(16)],a=0;a<16;a++)c[0][a]=g.toColor(b.theme0[0]*a/16,b.theme0[1]*a/16,b.theme0[2]*a/16),c[1][a]=g.toColor(b.theme0[0]*a/16-a*.2/16,b.theme0[1]*a/16-a*.2/16,b.theme0[2]*a/16-a*.2/16),c[2][a]=g.toColor(b.theme0[0]*a/16+a*.2/16,b.theme0[1]*a/16+a*.2/16,b.theme0[2]*a/16+a*.2/16),c[3][a]=g.toColor(b.theme0[0]*a/16-a*.4/16,b.theme0[1]*a/16-a*.4/16,b.theme0[2]*a/16-a*.4/16);Pip.setPalette(c)}}const c={};const a=require('fs');const b='USER/ThemePicker';const e='USER/ThemePicker/theme.json';const i=5;let j=0;let k=!1;let d=null;return c.run=function(){d=f(),h(d)},c}function onUserMount(b,a){a=a||0;try{fs.readdirSync('USER'),b()}catch(c){print('[Theme Picker Loader] USER not mounted yet, retrying...'),a<10?setTimeout(()=>onUserMount(b,a+1),300):print('[Theme Picker Loader] USER drive did not mount in time.')}}onUserMount(()=>{try{ThemePickerLoader().run(),delete onUserMount,delete ThemePickerLoader}catch(a){print('[Theme Picker Loader] Error loading:',a)}})