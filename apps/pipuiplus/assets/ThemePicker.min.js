function ThemePicker(){function s(){BTN_TUNEUP.read()&&(f=!f,j())}function j(){if(g.clear(),g.setFontMonofonto18(),g.setColor(a[0],a[1],a[2]),g.setFontAlign(0,0,0),g.drawString('Select the primary color of the theme',c/2,d/2-110),g.drawString('Move the tuner up to toggle 1 or 2 colours',c/2,d/2-90),f)switch(e){case 0:g.drawString('1: R*:'+a[0]+'G:'+a[1]+'B:'+a[2]+'   2: R:'+b[0]+'G:'+b[1]+'B:'+b[2],c/2,d/2-50);break;case 1:g.drawString('1: R:'+a[0]+'G*:'+a[1]+'B:'+a[2]+'   2: R:'+b[0]+'G:'+b[1]+'B:'+b[2],c/2,d/2-50);break;case 2:g.drawString('1: R:'+a[0]+'G:'+a[1]+'B*:'+a[2]+'   2: R:'+b[0]+'G:'+b[1]+'B:'+b[2],c/2,d/2-50);break;case 3:g.drawString('1: R:'+a[0]+'G:'+a[1]+'B:'+a[2]+'   2: R*:'+b[0]+'G:'+b[1]+'B:'+b[2],c/2,d/2-50);break;case 4:g.drawString('1: R:'+a[0]+'G:'+a[1]+'B:'+a[2]+'   2: R:'+b[0]+'G*:'+b[1]+'B:'+b[2],c/2,d/2-50);break;case 5:g.drawString('1: R:'+a[0]+'G:'+a[1]+'B:'+a[2]+'   2: R:'+b[0]+'G:'+b[1]+'B*:'+b[2],c/2,d/2-50);break;default:break}else switch(e){case 0:g.drawString('R*:'+a[0]+'G:'+a[1]+'B:'+a[2],c/2,d/2-50);break;case 1:g.drawString('R:'+a[0]+'G*:'+a[1]+'B:'+a[2],c/2,d/2-50);break;case 2:g.drawString('R:'+a[0]+'G:'+a[1]+'B*:'+a[2],c/2,d/2-50);break;default:break}g.drawString('Press left wheel in to save and reboot',c/2,d/2+90),g.drawString('Press torch to reset theme and reboot',c/2,d/2+110)}function t(){let h=-120;if(f)for(var e=0;e<16;e++){let f=0;g.setColor(((b[0]-a[0])*f+a[0])*e/16,((b[1]-a[1])*f+a[1])*e/16,((b[2]-a[2])*f+a[2])*e/16),g.fillRect(c/2-h,d/2-20,c/2-h+16,d/2-4),f=.33,g.setColor(((b[0]-a[0])*f+a[0])*e/16-e*.2/16,((b[1]-a[1])*f+a[1])*e/16-e*.2/16,((b[2]-a[2])*f+a[2])*e/16-e*.2/16),g.fillRect(c/2-h,d/2+-4,c/2-h+16,d/2+12),f=1,g.setColor(((b[0]-a[0])*f+a[0])*e/16+e*.2/16,((b[1]-a[1])*f+a[1])*e/16+e*.2/16,((b[2]-a[2])*f+a[2])*e/16+e*.2/16),g.fillRect(c/2-h,d/2+12,c/2-h+16,d/2+28),f=.66,g.setColor(((b[0]-a[0])*f+a[0])*e/16-e*.4/16,((b[1]-a[1])*f+a[1])*e/16-e*.4/16,((b[2]-a[2])*f+a[2])*e/16-e*.4/16),g.fillRect(c/2-h,d/2+28,c/2-h+16,d/2+44),h+=16}else for(var e=0;e<16;e++)g.setColor(a[0]*e/16,a[1]*e/16,a[2]*e/16),g.fillRect(c/2-h,d/2-20,c/2-h+16,d/2-4),g.setColor(a[0]*e/16-e*.2/16,a[1]*e/16-e*.2/16,a[2]*e/16-e*.2/16),g.fillRect(c/2-h,d/2+-4,c/2-h+16,d/2+12),g.setColor(a[0]*e/16+e*.2/16,a[1]*e/16+e*.2/16,a[2]*e/16+e*.2/16),g.fillRect(c/2-h,d/2+12,c/2-h+16,d/2+28),g.setColor(a[0]*e/16-e*.4/16,a[1]*e/16-e*.4/16,a[2]*e/16-e*.4/16),g.fillRect(c/2-h,d/2+28,c/2-h+16,d/2+44),h+=16}function m(){clearInterval(l),l=null,i&&(clearWatch(i),i=null),Pip.removeListener('knob1',o),Pip.removeListener('knob2',p),Pip.removeListener('torch',q),E.reboot()}function o(c){if(Pip.knob1Click(c),c==0)f!=f,v(),m();else if(f&&e>2){if(b[e%3]+=c*.01,b[e%3]<0){b[e%3]=0;return}if(b[e%3]>1){b[e%3]=1;return}}else{if(a[e]+=c*.01,a[e]<0){a[e]=0;return}if(a[e]>1){a[e]=1;return}}j()}function p(a){if(Pip.knob2Click(a),e+=a,e<0){e=0;return}if(!f&&e>2){e=2;return}if(f&&e>5){e=5;return}j()}function q(){u(),m()}function r(){try{fs.readdirSync(h)}catch(a){return fs.mkdir(h),r()}try{let d=fs.readFileSync(k);let c=JSON.parse(d);a=c.theme0,b=c.theme1,f=c.gradient}catch(a){return}}function u(){try{fs.unlink(k)}catch(a){}}function v(){try{fs.readdirSync(h)}catch(a){fs.mkdir(h)}let c={gradient:f,theme0:a,theme1:b};let d=JSON.stringify(c);fs.writeFile(k,d)}const n={};const c=g.getWidth();const d=g.getHeight();const h='USER/ThemePicker';const k='USER/ThemePicker/theme.json';let f=!1;let l=null;let i=null;let e=0;let a=[1,1,1];let b=[1,1,1];return n.run=function(){Pip.on('knob1',o),Pip.on('knob2',p),Pip.on('torch',q),r(),j(),l=setInterval(()=>{t(),s()},250),i=setWatch(function(){m()},BTN_POWER,{debounce:50,edge:'rising',repeat:!0})},n}ThemePicker().run()