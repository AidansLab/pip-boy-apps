!function(u){function H(){try{const b=fs.readFileSync('DATA/ICONS.json');const a=JSON.parse(b);c={};for(var u in a)c[u]=atob(a[u])}catch(a){c={}}y=function(a){if(k=null,a&&a.image)try{const c=fs.readFileSync('DATA/'+a.image);const b=new Function('return ('+c+')')();b.buffer=E.toArrayBuffer(b.buffer),k=b}catch(a){}},z=function(b,k,e,n){if(!b||b.length===0)return e;let f=0;b.forEach(function(a){const b=c[a.type];const e=bC.stringWidth(a.value);let d=0;if(b){const c=g.imageMetrics(b);const e=a.type==='attack'&&k==='Damage'?15:14;const f=e/c.height;d=c.width*f}f=Math.max(f,e+d+20)});const i=a+l-f;const o=b.length*d;const j=n+h+e;return bC.setColor(m),bC.fillRect(a+4,j-2,i-4,j+o-4),bC.setBgColor(m),bC.setColor(v),bC.drawString(k,a+h,j),b.forEach(function(j){const b=n+h+e;const f=c[j.type];if(bC.setColor(m),bC.fillRect(i,b-2,a+l-4,b+d-4),bC.setBgColor(m),bC.setColor(v),f){const a=g.imageMetrics(f);const e=j.type==='attack'&&k==='Damage'?15:14;const c=e/a.height;const h=b+(d-4-a.height*c)/2;bC.drawImage(f,i+2,h,{scale:c})}bC.setFontAlign(1,-1),bC.drawString(j.value,a+l-h,b),bC.setFontAlign(-1,-1),e+=d}),e},A=function(b){if(bC.setFontMonofonto16(),!b)return;const j=(b.damages?b.damages.length:0)+(b.defenses?b.defenses.length:0)+(b.stats?Object.keys(b.stats).length:0);if(j===0)return;const k=j*d+h*2-2;const i=I-k;let e=0;if(e=z(b.damages,'Damage',e,i),e=z(b.defenses,'DMG Resist',e,i),b.stats)for(var f in b.stats){const j=i+h+e;const k=b.stats[f];const n=(typeof k)[0]=='o'&&k!==null;const o=n?k.value:k;const r=n&&k.isTimed;const p=f===b.ammoType;p?(bC.setColor(m),bC.fillRect(a+4,j,a+l-4,j+d-4),bC.setBgColor(m)):(F(a+4,j,l-8,d-2),bC.setBgColor(0)),bC.setColor(v);const q=a+l-h;if(p){let b=a+h;if(c.ammo){const a=g.imageMetrics(c.ammo);const e=14/a.height;const f=j+(d-4-a.height*e)/2;bC.drawImage(c.ammo,b,f,{scale:e})}b+=16,bC.drawString(f,b,j)}else bC.drawString(f,a+h,j);if(bC.setFontAlign(1,-1),bC.drawString(o,q,j),r){const a=g.imageMetrics(c.time);const b=14/a.height;const e=j-1+(d-4-a.height*b)/2;const f=q-bC.stringWidth(o)-a.width*b-7;bC.drawImage(c.time,f,e,{scale:b})}bC.setFontAlign(-1,-1),e+=d}},x=function(g){if(o)if(Pip.audioIsPlaying())return;else o=!1;const l=p(f);const c=b>0?e[l.local]:null;if(g===0){if(!c)return;if(c.type==='weapon'||c.type==='apparel'){o=!0;let a=Object.prototype.toString.call(c.equipSlots)==='[object Array]'?c.equipSlots:[c.equipSlots];a.length>0&&Array.isArray(a[0])&&(a=a[0]);let d=j[a[0]]===c.name;let e=null;let b=null;if(c.type==='weapon'?b=d?['EquipDown_01.wav','EquipDown_02.wav','EquipDown_03.wav']:['EquipUp_02.wav','EquipUp_03.wav']:b=d?['EquipDown_01.wav','EquipDown_02.wav','EquipDown_03.wav']:['EquipUp_01.wav'],e=b[Math.floor(Math.random()*b.length)],d)a.forEach(function(a){j[a]=null});else{let b=[];if(a.forEach(function(c){let a=j[c];a&&b.indexOf(a)===-1&&b.push(a)}),b.length>0)for(var h in j)b.indexOf(j[h])!==-1&&(j[h]=null);a.forEach(function(a){j[a]=c.name})}e&&Pip.audioStart('DATA/'+e),s()}else c.sounds&&c.sounds.length>0&&(o=!0,Pip.audioStart('DATA/'+c.sounds[Math.floor(Math.random()*c.sounds.length)]));return}if(b<=1)return;if(Pip.knob1Click(g),q=f,f-=g,f=(f%b+b)%b,f===q)return;let i=p(q);let d=p(f);let m=d.page!==i.page;m?(B(d.page),s()):(y(e[d.local]),bC.setBgColor(0),bC.clearRect(a,0,bC.getWidth(),bC.getHeight()),k&&bC.drawImage(k,a+20,20),t(i.local,d.local),t(d.local,d.local),A(e[d.local]),bC.flip())},s=function(){if(b===0){bC.clear(1).setFontMonofonto18().setColor(3).drawString('Inventory empty.',25,C+3).flip();return}const c=p(f);y(e[c.local]),bC.clear(1),k&&bC.drawImage(k,a+20,20);for(var d=0;d<e.length;d++)t(d,c.local);A(e[c.local]),bC.flip()},F=function(b,c,d,e){bC.setColor(J);for(var a=c;a<c+e;a+=2)bC.fillRect(b,a,b+d,a)},G=function(){try{const d=JSON.parse(fs.readFileSync('DATA/items_meta.json'));i=d.pageCounts,b=0;for(var a=0;a<i.length;a++)b+=i[a];n=[];for(var c=0;c<i.length;c++)n.push('items_'+c+'.json')}catch(a){b=0}},B=function(a){if(a<0||a>=n.length||w===a)return!1;try{return e=JSON.parse(fs.readFileSync('DATA/'+n[a])),w=a,!0}catch(a){return e=[],!1}},p=function(c){if(b===0)return{page:0,local:0};c=(c%b+b)%b;let d=0;for(var a=0;a<i.length;a++){if(c<d+i[a])return{page:a,local:c-d};d+=i[a]}return{page:0,local:0}},t=function(d,k){const f=e[d];const c=C+d*D;const g=23;const l=a-15-g;bC.setBgColor(d===k?3:0),bC.setColor(d===k?0:3),bC.clearRect(10,c,a-10,c+D-1),bC.setFontMonofonto16(),Object.values(j).includes(f.name)&&bC.fillRect(12,c+8,18,c+14);const h=' ('+f.quantity+')';const m=bC.stringWidth(h);let b=f.name;const i=l-m;if(bC.stringWidth(b)>i){let a='';for(let e=0;e<b.length;e++){if(bC.stringWidth(a+b[e]+'...')>i)break;a+=b[e]}b=a+'...'}bC.drawString(b+h,g,c+3)},r=Pip.removeSubmenu,G(),b>0&&(B(0),f=0),s(),Pip.on('knob1',x),Pip.removeSubmenu=K}function K(){L()}function L(){Pip.removeListener('knob1',x),r&&(Pip.removeSubmenu=r,r=null),e=[],n=[],i=[],k=null,o=!1,b=0,w=-1,f=0,q=-1,c=null,y=null,z=null,x=null,A=null,F=null,G=null,B=null,p=null,t=null,s=null,process.memory(),g.reset&&g.reset()}const C=10,D=22,a=220,I=205;const l=170,h=8,d=20,v=3,m=1,J=1;let e=[],n=[],i=[],b=0,w=-1;let f=0,q=-1;let j={weapon:null,hat:null,eyewear:null,mask:null,clothing:null,chest:null,leftArm:null,rightArm:null,leftLeg:null,rightLeg:null,accessory:null};let k=null,o=!1;let r=null;let c=null;let x,y,z,A,s,F,G,B,p,t;if(MODEINFO[2]&&MODEINFO[2].submenu){let b=MODEINFO[2].submenu;let a={};let c=!1;for(u in b)u==='ATTACHMENTS'&&(a.ITEMS=H,c=!0),a[u]=b[u];c||(a.ITEMS=H),MODEINFO[2].submenu=a}}()